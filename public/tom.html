<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
</head>
<body>

    <script>
        var config = {
                type: Phaser.AUTO,
                width: 800,
                height: 600,
                physics: {
                    default: 'arcade',
                    arcade: {
                        debug: false
                    }
                },
                scene: {
                    preload: preload,
                    create: create,
                    update: update
                }
        }

        var game = new Phaser.Game(config) // initialise game variable

        function preload ()
        {
            this.load.image('sky', 'assets/sky.png')
            this.load.image('wall', 'assets/platform.png')
            
            this.load.spritesheet('dude', 'assets/dude.png', { frameWidth: 32, frameHeight: 48})
        }

        function create ()
        {
            this.add.image(400, 300, 'sky') //add sky background

            walls = this.physics.add.staticGroup() // create walls

            walls.create(400, 568, 'wall').setScale(2).refreshBody()
            
            player = this.physics.add.sprite(100, 450, 'dude') // create player

            // creates the animations for the sprites

            this.anims.create({
                key: 'left',
                frames: this.anims.generateFrameNumbers('dude', { start: 0, end: 3 }),
                frameRate: 10,
                repeat: -1
            })

            this.anims.create({
                key: 'turn',
                frames: [ { key: 'dude', frame: 4 } ],
                frameRate: 20
            })

            this.anims.create({
                key: 'right',
                frames: this.anims.generateFrameNumbers('dude', { start: 5, end: 8 }),
                frameRate: 10,
                repeat: -1
            })

            this.anims.create({
                key: 'up',
                frames: this.anims.generateFrameNumbers('dude', { start: 5, end: 8 }),
                frameRate: 10,
                repeat: -1
            })
            
            this.anims.create({
                key: 'down',
                frames: this.anims.generateFrameNumbers('dude', { start: 0, end: 3 }),
                frameRate: 10,
                repeat: -1
            })

            this.physics.add.collider(player, walls) // creates collision with player and walls

            cursors = this.input.keyboard.createCursorKeys() // initialise keyboard controls
        }

        function update ()
        {

            // keyboard controls
            if (cursors.up.isDown && cursors.left.isDown)
            {
                player.setVelocityX(-160)
                player.setVelocityY(-160)
                
                player.anims.play('left', true)
            }
            else if (cursors.up.isDown && cursors.right.isDown)
            {
                player.setVelocityX(160)
                player.setVelocityY(-160)
                
                player.anims.play('right', true)
            }
            else if (cursors.down.isDown && cursors.left.isDown)
            {
                player.setVelocityX(-160)
                player.setVelocityY(160)
                
                player.anims.play('left', true)
            }
            else if (cursors.down.isDown && cursors.right.isDown)
            {
                player.setVelocityX(160)
                player.setVelocityY(160)
                
                player.anims.play('right', true)
            }
            else if (cursors.left.isDown)
            {
                player.setVelocityX(-160);

                player.anims.play('left', true)
            }
            else if (cursors.right.isDown)
            {
                player.setVelocityX(160);

                player.anims.play('right', true)
            }
            else if (cursors.up.isDown)
            {
                player.setVelocityY(-160)

                player.anims.play('up', true)
            }
            else if (cursors.down.isDown)
            {
                player.setVelocityY(160)

                player.anims.play('down', true)
            }
            else
            {
                player.setVelocityX(0)

                player.setVelocityY(0)

                player.anims.play('turn')
            }
        }
    </script>

</body>
</html>