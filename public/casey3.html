<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser-arcade-physics.min.js"></script>
</head>
<body>

    <script>

    let CoinLayer, BackgroundLayer, GroundLayer, coins, player, car;
    let coinScore = 0;

    var config = {
        type: Phaser.AUTO,
        width: 800,
        height: 576,
        physics: {
            default: 'arcade',
            arcade: {
                // gravity: { y: 300 },
                debug: true
            }
        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };

    var game = new Phaser.Game(config);

    function preload () {
        this.load.tilemapTiledJSON('test4', 'assets/maps/test4.json');
        this.load.image("roadEW", "assets/maps/roadEW.png")
        this.load.image('car', 'assets/maps/Daco_4361360.png')
    }

    function create () {
        this.physics.world.setBounds(0, 0, 1600, 576);
        
        const map = this.make.tilemap({key: 'test4'});   
        const tileset = map.addTilesetImage('roadEW', 'roadEW')
        
        BackgroundLayer = map.createLayer('Tile Layer 1', tileset)

        car = this.physics.add.image(100, 100, 'car').setScale(0.04)

        // map.setCollisionBetween(0, 923, true, 'Tile Layer 1')

        this.cameras.main.setBounds(0, 0, 1600, 576);
        this.cameras.main.startFollow(car);
        
        // player.setBounce(0.2);
        car.setCollideWorldBounds(true);
        // player.body.setGravityY(300);

        cursors = this.input.keyboard.createCursorKeys();
    }

    function update () {
        if (cursors.left.isDown && cursors.up.isDown) {
            car.setVelocityX(-160)
            car.setVelocityY(-160)
            car.angle = 45
        } else if (cursors.right.isDown && cursors.up.isDown) {
            car.setVelocityX(160)
            car.setVelocityY(-160)
            car.angle = 135
        } else if (cursors.right.isDown && cursors.down.isDown) {
            car.setVelocityX(160)
            car.setVelocityY(160)
            car.angle = 225
        } else if (cursors.left.isDown && cursors.down.isDown) {
            car.setVelocityX(-160)
            car.setVelocityY(160)
            car.angle = 315
        } else if (cursors.left.isDown) {
            car.setVelocityX(-160)
            car.angle = 0
        } else if (cursors.right.isDown) {
            car.setVelocityX(160)
            car.angle = 180
        } else if (cursors.up.isDown) {
            car.setVelocityY(-160)
            car.angle = 90
        } else if (cursors.down.isDown) {
            car.setVelocityY(160)
            car.angle = 270
        } else {
            car.setVelocityX(0)
            car.setVelocityY(0)
        }
    }

    </script>

</body>
</html>